{% extends 'core/base.html' %}
{% load i18n %}

{% block title %}{% trans "Profile" %} — AkkaUi{% endblock %}

{% block content %}
  <style>
    .subscription-details {
      background: rgba(163, 230, 53, 0.1);
      border: 1px solid var(--primary);
      border-radius: 8px;
      padding: 1rem;
      margin-top: 0.5rem;
    }
    .subscription-details p {
      margin: 0.5rem 0;
    }
    .subscription-details strong {
      color: var(--primary);
    }
    .text-muted {
      color: var(--text-gray-400);
      font-size: 0.875rem;
      margin-top: 0.75rem;
    }
    .profile-vip .vip-badge {
      color: var(--primary);
      font-weight: 600;
    }
  </style>
  
  <article class="page">
    <header class="page-header">
      <h1>{% trans "My Profile" %}</h1>
      <p class="lead">{% trans "Manage your personal information" %}</p>
    </header>

    <div class="page-body">
      <div class="profile-container">
        {% if messages %}
          <div class="messages">
            {% for message in messages %}
              <div class="message {% if message.tags %}message-{{ message.tags }}{% endif %}">
                {{ message }}
              </div>
            {% endfor %}
          </div>
        {% endif %}

        <div class="profile-info">
          <div class="profile-field">
            <label>{% trans "Username" %}</label>
            <p>{{ user.username }}</p>
          </div>

          <div class="profile-field">
            <label>{% trans "Email" %}</label>
            <p>{{ user.email }}</p>
          </div>

          {% if user.phone %}
          <div class="profile-field">
            <label>{% trans "Phone" %}</label>
            <p>{{ user.phone }}</p>
          </div>
          {% endif %}

          <div class="profile-field">
            <label>{% trans "Member since" %}</label>
            <p>{{ user.date_joined|date:"d/m/Y" }}</p>
          </div>

          {% if user.is_vip %}
          <div class="profile-field profile-vip">
            <label>{% trans "Status" %}</label>
            <p class="vip-badge">
              {% trans "Subscriber" %}
              {% if user.vip_expiration %}
                — {% trans "until" %} {{ user.vip_expiration|date:"d/m/Y" }}
              {% endif %}
            </p>
          </div>
          
          <div class="profile-field profile-subscription-info">
            <label>{% trans "Subscription Information" %}</label>
            <div class="subscription-details">
              <p>
                <strong>{% trans "Next billing date" %}:</strong>
                {% if user.vip_expiration %}
                  {{ user.vip_expiration|date:"d/m/Y" }}
                {% else %}
                  {% trans "Not available" %}
                {% endif %}
              </p>
              <p class="text-muted">
                {% trans "Your subscription will automatically renew on the date shown above. You can manage or cancel your subscription at any time through your payment provider's dashboard." %}
              </p>
            </div>
          </div>
            <div class="profile-actions">
              <a href="{% url 'usuario:stripe_customer_portal' %}" class="btn btn-primary">
                {% trans "Manage Subscription" %}
              </a>
            </div>
          {% endif %}
        </div>

        <div class="profile-actions">
          <a href="{% url 'usuario:signout' %}" class="btn btn-secondary">{% trans "Sign Out" %}</a>
        </div>
      </div>
    </div>
  </article>
{% endblock %}
