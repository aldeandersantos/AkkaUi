{% extends 'core/base.html' %}
{% load static %}

{% block title %}Explorar ‚Äî AkkaUi{% endblock %}

{% block sidebar %}
{# Sidebar lateral com filtros #}
<aside class="explore-sidebar">
  <form method="get" action="{% url 'core:explore' %}" class="sidebar-filters-form">
    <h3 class="sidebar-title">Filtros</h3>
    
    {# Barra de pesquisa na sidebar #}
    <div class="sidebar-filter-group">
      <label for="sidebar-search">Pesquisar</label>
      <input 
        type="search" 
        name="q" 
        id="sidebar-search"
        value="{{ search_query }}" 
        placeholder="Buscar por t√≠tulo..." 
        class="sidebar-search-input"
        aria-label="Pesquisar SVGs por t√≠tulo"
      >
    </div>
    
    {# Filtro por categoria #}
    <div class="sidebar-filter-group">
      <label for="sidebar-category">Categoria</label>
      <select name="category" id="sidebar-category" class="sidebar-select" onchange="this.form.submit()">
        <option value="">Todas</option>
        {% for cat in all_categories %}
          <option value="{{ cat }}" {% if cat == selected_category %}selected{% endif %}>{{ cat }}</option>
        {% endfor %}
      </select>
    </div>
    
    {# Filtro por tag #}
    <div class="sidebar-filter-group">
      <label for="sidebar-tag">Tag</label>
      <select name="tag" id="sidebar-tag" class="sidebar-select" onchange="this.form.submit()">
        <option value="">Todas</option>
        {% for t in all_tags %}
          <option value="{{ t }}" {% if t == selected_tag %}selected{% endif %}>{{ t }}</option>
        {% endfor %}
      </select>
    </div>
    
    {# Ordena√ß√£o #}
    <div class="sidebar-filter-group">
      <label for="sidebar-sort">Ordenar</label>
      <select name="sort" id="sidebar-sort" class="sidebar-select" onchange="this.form.submit()">
        <option value="-uploaded_at" {% if selected_sort == '-uploaded_at' %}selected{% endif %}>Mais recentes</option>
        <option value="uploaded_at" {% if selected_sort == 'uploaded_at' %}selected{% endif %}>Mais antigos</option>
        <option value="title_name" {% if selected_sort == 'title_name' %}selected{% endif %}>Nome (A-Z)</option>
        <option value="-title_name" {% if selected_sort == '-title_name' %}selected{% endif %}>Nome (Z-A)</option>
      </select>
    </div>
    
    {# Bot√µes #}
    <div class="sidebar-actions">
      <button type="submit" class="sidebar-btn sidebar-btn-primary">üîç Buscar</button>
      {% if search_query or selected_category or selected_tag or selected_sort != '-uploaded_at' %}
        <a href="{% url 'core:explore' %}" class="sidebar-btn sidebar-btn-secondary">‚úï Limpar</a>
      {% endif %}
    </div>
  </form>
</aside>
{% endblock %}

{% block content %}
<div class="explore-content">
  <header class="explore-header">
    <h1>Explorar SVGs</h1>
    <p>Descubra nossa cole√ß√£o de SVGs salvos no sistema</p>
  </header>

  <section class="explore-results">
    {% if svgfiles %}
      {# Contador de resultados #}
      <p class="results-counter">
        {% if search_query or selected_category or selected_tag %}
          Encontrado{{ svgfiles|length|pluralize }} {{ svgfiles|length }} resultado{{ svgfiles|length|pluralize }}
        {% else %}
          Exibindo {{ svgfiles|length }} SVG{{ svgfiles|length|pluralize }} p√∫blico{{ svgfiles|length|pluralize }}
        {% endif %}
      </p>
      <div class="container-cards">
        {% for item in svgfiles %}
          {% include 'core/partials/item_card.html' with item=item %}
        {% endfor %}
      </div>
    {% else %}
      {% if search_query or selected_category or selected_tag %}
        <p class="no-results">
          Nenhum resultado encontrado. Tente ajustar os filtros.
        </p>
      {% else %}
        <p class="no-results">
          Nenhum SVG p√∫blico dispon√≠vel ainda. Fa√ßa upload do primeiro!
        </p>
      {% endif %}
    {% endif %}
  </section>
</div>
{% endblock %}
