{% extends 'core/base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "Explore" %} ‚Äî AkkaUi{% endblock %}

{% block sidebar %}
{# Sidebar lateral com filtros #}
<aside class="explore-sidebar">
  <form method="get" action="{% url 'core:explore' %}" class="sidebar-filters-form">
    <h3 class="sidebar-title">{% trans "Filters" %}</h3>
    
    {# Barra de pesquisa na sidebar #}
    <div class="sidebar-filter-group">
      <label for="sidebar-search">{% trans "Search" %}</label>
      <input 
        type="search" 
        name="q" 
        id="sidebar-search"
        value="{{ search_query }}" 
        placeholder="{% trans "Search by title..." %}" 
        class="sidebar-search-input"
        aria-label="{% trans "Search SVGs by title" %}"
      >
    </div>
    
    {# Filtro por categoria #}
    <div class="sidebar-filter-group">
      <label for="sidebar-category">{% trans "Category" %}</label>
      <select name="category" id="sidebar-category" class="sidebar-select" onchange="this.form.submit()">
        <option value="">{% trans "All" %}</option>
        {% for cat in all_categories %}
          <option value="{{ cat }}" {% if cat == selected_category %}selected{% endif %}>{{ cat }}</option>
        {% endfor %}
      </select>
    </div>
    
    {# Filtro por tag #}
    <div class="sidebar-filter-group">
      <label for="sidebar-tag">{% trans "Tag" %}</label>
      <select name="tag" id="sidebar-tag" class="sidebar-select" onchange="this.form.submit()">
        <option value="">{% trans "All" %}</option>
        {% for t in all_tags %}
          <option value="{{ t }}" {% if t == selected_tag %}selected{% endif %}>{{ t }}</option>
        {% endfor %}
      </select>
    </div>
    
    {# Ordena√ß√£o #}
    <div class="sidebar-filter-group">
      <label for="sidebar-sort">{% trans "Sort" %}</label>
      <select name="sort" id="sidebar-sort" class="sidebar-select" onchange="this.form.submit()">
        <option value="-uploaded_at" {% if selected_sort == '-uploaded_at' %}selected{% endif %}>{% trans "Most recent" %}</option>
        <option value="uploaded_at" {% if selected_sort == 'uploaded_at' %}selected{% endif %}>{% trans "Oldest" %}</option>
        <option value="title_name" {% if selected_sort == 'title_name' %}selected{% endif %}>{% trans "Name (A-Z)" %}</option>
        <option value="-title_name" {% if selected_sort == '-title_name' %}selected{% endif %}>{% trans "Name (Z-A)" %}</option>
      </select>
    </div>
    
    {# Bot√µes #}
    <div class="sidebar-actions">
      <button type="submit" class="sidebar-btn sidebar-btn-primary">üîç {% trans "Search" %}</button>
      {% if search_query or selected_category or selected_tag or selected_sort != '-uploaded_at' %}
        <a href="{% url 'core:explore' %}" class="sidebar-btn sidebar-btn-secondary">‚úï {% trans "Clear" %}</a>
      {% endif %}
    </div>
  </form>
</aside>
{% endblock %}

{% block content %}
<div class="explore-content">
  <header class="explore-header">
    <h1>{% trans "Explore SVGs" %}</h1>
    <p>{% trans "Discover our collection of SVGs saved in the system" %}</p>
  </header>

  <section class="explore-results">
    {% if svgfiles %}
      {# Contador de resultados #}
      <p class="results-counter">
        {% if search_query or selected_category or selected_tag %}
          {% blocktrans count counter=svgfiles|length %}Found {{ counter }} result{% plural %}Found {{ counter}} results{% endblocktrans %}
        {% else %}
          {% blocktrans count counter=svgfiles|length %}Showing {{ counter }} public SVG{% plural %}Showing {{ counter }} public SVGs{% endblocktrans %}
        {% endif %}
      </p>
      <div class="container-cards">
        {% for item in svgfiles %}
          {% include 'core/partials/item_card.html' with item=item %}
        {% endfor %}
      </div>
    {% else %}
      {% if search_query or selected_category or selected_tag %}
        <p class="no-results">
          {% trans "No results found. Try adjusting the filters." %}
        </p>
      {% else %}
        <p class="no-results">
          {% trans "No public SVGs available yet. Upload the first one!" %}
        </p>
      {% endif %}
    {% endif %}
  </section>
</div>
{% endblock %}
